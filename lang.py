import numpy as np
import os
import json
import pickle
from collections import defaultdict
from importance import permutation_importance

files = ['ffridataset2020_malware.jsonl', 'ffridataset2020_cleanware.jsonl']
lang = set()
sublang = set()
for fname in files:
    with open(fname) as fp:
        for line in fp:
            data = json.loads(line)
            lief = data['lief']
            rsc = lief.get('resources_manager')
            if rsc is not None:
                icn = rsc.get('icons')
                if icn is not None:
                    for e in icn:
                        lang.add(e['lang'])
                        sublang.add(e['sublang'])

lang = list(lang)
sublang = list(sublang)
lang.sort()
sublang.sort()

with open('lang.txt', 'wb') as fp:
    pickle.dump(lang, fp)

with open('sublang.txt', 'wb') as fp:
    pickle.dump(sublang, fp)

print(len(lang))
print(len(sublang))
print(lang)
print(sublang)
