import numpy as np
import os
import json
import pickle
from collections import defaultdict
from importance import permutation_importance

files = ['ffridataset2020_malware.jsonl', 'ffridataset2020_cleanware.jsonl']

count = set()

for fname in files:
    with open(fname) as fp:
        for line in fp:
            debug = defaultdict(int)
            data = json.loads(line)
            lief = data['lief']
            dbg = lief.get('debug')
            if dbg is not None:
                for d in dbg:
                    debug[d['type']] += 1
            for k, v in debug.items():
                if v > 1:
                    count.add(k)

print(count)
